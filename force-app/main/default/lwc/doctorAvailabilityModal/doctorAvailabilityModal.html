<template>
  <section class="slds-modal slds-fade-in-open" role="dialog">
    <div class="slds-modal__container">
      <header class="slds-modal__header">
        <h2 class="slds-text-heading_medium">Availability â€” {doctorName}</h2>
      </header>

      <div class="slds-modal__content slds-p-around_medium">

        <lightning-combobox
          name="treatment"
          label="Select Treatment"
          value={selectedTreatmentId}
          options={treatments}
          onchange={handleTreatmentChange}>
        </lightning-combobox>

        <lightning-input
          type="date"
          label="Select Date"
          value={selectedDate}
          onchange={handleDateChange}>
        </lightning-input>

        <lightning-button
          label="Check Slots"
          variant="brand"
          class="slds-m-top_small"
          onclick={fetchSlots}
          disabled={disableCheck}>
        </lightning-button>

        <template if:true={slots.length}>
          <p class="slds-m-top_medium slds-text-title_caps">Available Slots</p>
          <div class="slot-grid">
            <template for:each={slots} for:item="s">
              <div
                key={s}
                data-slot={s}
                data-selected={s}
                class="slot"
                onclick={selectSlot}>
                {s}
              </div>
            </template>
          </div>

          <div class="slds-align_absolute-center slds-m-top_large">
            <lightning-button
              label="Book Appointment"
              variant="brand"
              onclick={handleBookClick}>
            </lightning-button>
          </div>
        </template>
      </div>

      <footer class="slds-modal__footer">
        <lightning-button label="Close" onclick={close}></lightning-button>
      </footer>
    </div>
  </section>

  <div class="slds-backdrop slds-backdrop_open"></div>

  <template if:true={showConfirm}>
    <section class="slds-modal slds-fade-in-open" role="dialog">
      <div class="slds-modal__container">
        <header class="slds-modal__header">
          <h2 class="slds-text-heading_medium">Confirm Booking</h2>
        </header>

        <div class="slds-modal__content slds-p-around_medium">
          <p>
            Book an appointment with <strong>{doctorName}</strong> on
            <strong>{selectedDate}</strong> at <strong>{selectedSlot}</strong>?
          </p>
        </div>

        <footer class="slds-modal__footer slds-grid slds-grid_align-end">
          <lightning-button
            label="Cancel"
            onclick={closeConfirm}>
          </lightning-button>
          <lightning-button
            variant="brand"
            label="Yes, Book"
            onclick={confirmBooking}>
          </lightning-button>
        </footer>
      </div>
    </section>

    <div class="slds-backdrop slds-backdrop_open"></div>
  </template>
</template>
